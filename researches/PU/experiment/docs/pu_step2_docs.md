# –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç PU Learning - –®–∞–≥ 2: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìã –û–±–∑–æ—Ä

–í—Ç–æ—Ä–æ–π —à–∞–≥ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ PU Learning - **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**. –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Å –æ—Å–æ–±—ã–º –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–µ PU Learning –∑–∞–¥–∞—á.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- üéØ **–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- üîß **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤** - —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
- üè∑Ô∏è **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** - —á–∏—Å–ª–µ–Ω–Ω—ã–µ vs –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ
- üì¶ **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞** - –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

### –û–±—â–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

```mermaid
graph TB
    subgraph Input["üì• –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"]
        DF[/"–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π DataFrame"/]
        Config[/"–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"/]
        Target[/"–ò–º—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π"/]
    end
    
    subgraph Step2["üîß –®–∞–≥ 2: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞"]
        S1["1Ô∏è‚É£ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ X –∏ y"]
        S2["2Ô∏è‚É£ –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤"]
        S3["3Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤"]
        S4["4Ô∏è‚É£ Train/Test split —Å–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π"]
        S5["5Ô∏è‚É£ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π"]
        S6["6Ô∏è‚É£ –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö"]
        S7["7Ô∏è‚É£ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö"]
        S8["8Ô∏è‚É£ –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"]
        
        S1 --> S2 --> S3 --> S4
        S4 --> S5 --> S6 --> S7 --> S8
    end
    
    subgraph Output["üì§ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"]
        XTrain["X_train"]
        XTest["X_test"]
        YTrain["y_train"]
        YTest["y_test"]
        Stats["üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"]
        Pipeline["üîÑ Pipeline"]
    end
    
    Input --> Step2
    Step2 --> Output
    
    style Step2 fill:#2C5282,stroke:#5BA0E5,stroke-width:3px,color:#fff
    style S4 fill:#FF9800,stroke:#F57C00,color:#fff
    style Pipeline fill:#4CAF50,stroke:#388E3C,color:#fff
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–Ω–≤–µ–π–µ—Ä–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

```mermaid
graph LR
    subgraph Previous["‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —à–∞–≥–∏"]
        style Previous fill:#E8F5E9,stroke:#4CAF50,stroke-width:2px
        S1["–®–∞–≥ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è"]
        style S1 fill:#4CAF50,color:#fff
    end
    
    subgraph Current["üéØ –¢–µ–∫—É—â–∏–π —à–∞–≥"]
        style Current fill:#FFF3E0,stroke:#FF9800,stroke-width:3px
        S2["–®–∞–≥ 2: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞"]
        style S2 fill:#FF9800,color:#fff
    end
    
    subgraph Future["‚è≥ –ë—É–¥—É—â–∏–µ —à–∞–≥–∏"]
        style Future fill:#f9f9f9,stroke:#ddd,stroke-width:1px
        S3["–®–∞–≥ 3: –°–∏–º—É–ª—è—Ü–∏—è PU"]
        S4["–®–∞–≥ 4: –ú–µ—Ç–æ–¥—ã"]
        S5["–®–∞–≥ 5: –û–±—É—á–µ–Ω–∏–µ"]
        S6["–®–∞–≥ 6: –ú–µ—Ç—Ä–∏–∫–∏"]
        S7["–®–∞–≥ 7: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è"]
        S8["–®–∞–≥ 8: –û—Ç—á—ë—Ç"]
    end
    
    Data[/"–î–∞–Ω–Ω—ã–µ"/] --> S1
    S1 -.->|"–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ<br/>–¥–∞–Ω–Ω—ã–µ"| S2
    S2 -.->|"X_train, X_test<br/>y_train, y_test"| S3
    S3 --> S4 --> S5 --> S6 --> S7 --> S8
    S8 --> Report[/"HTML –æ—Ç—á—ë—Ç"/]
```

## üîß –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

```mermaid
graph TD
    Feature[/"–ü—Ä–∏–∑–Ω–∞–∫"/] --> CheckDtype{–ü—Ä–æ–≤–µ—Ä–∫–∞ dtype}
    
    CheckDtype -->|Object| Cat1["üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π"]
    
    CheckDtype -->|Numerical| CheckCardinality{–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö < 10<br/>–ò < 5% –æ—Ç –¥–∞–Ω–Ω—ã—Ö?}
    CheckCardinality -->|–î–∞| Cat2["üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π<br/>(–∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–∏—Å–ª–∞–º–∏)"]
    CheckCardinality -->|–ù–µ—Ç| Num["üìä –ß–∏—Å–ª–æ–≤–æ–π"]
    
    Cat1 --> CheckHighCard{–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö > 50?}
    Cat2 --> CheckHighCard
    CheckHighCard -->|–î–∞| Warning["‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å"]
    CheckHighCard -->|–ù–µ—Ç| OK["‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å"]
    
    style Cat1,Cat2 fill:#9C27B0,color:#fff
    style Num fill:#2196F3,color:#fff
    style Warning fill:#FF9800,color:#fff
    style OK fill:#4CAF50,color:#fff
```

### 2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```mermaid
graph LR
    subgraph Missing["üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤"]
        subgraph Numerical["–ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏"]
            N1["–ú–µ–¥–∏–∞–Ω–∞ (default)"]
            N2["–°—Ä–µ–¥–Ω–µ–µ"]
            N3["–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞"]
        end
        
        subgraph Categorical["–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏"]
            C1["–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ 'missing' (default)"]
            C2["–ù–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ"]
            C3["–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"]
        end
    end
    
    style Numerical fill:#2196F3,color:#fff
    style Categorical fill:#9C27B0,color:#fff
    style N1,C1 fill:#4CAF50,color:#fff
```

### 3. –ú–µ—Ç–æ–¥—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

```mermaid
graph TD
    Cat[/"–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫"/] --> Method{–ú–µ—Ç–æ–¥ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è}
    
    Method -->|Target Encoding| TE["üéØ Target Encoding<br/>–õ—É—á—à–µ –¥–ª—è PU Learning<br/>–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å"]
    Method -->|Label Encoding| LE["üè∑Ô∏è Label Encoding<br/>–ü—Ä–æ—Å—Ç–æ–π –ø–æ—Ä—è–¥–∫–æ–≤—ã–π<br/>–ë—ã—Å—Ç—Ä—ã–π"]
    Method -->|One-Hot| OH["üî• One-Hot Encoding<br/>–°–æ–∑–¥–∞—ë—Ç –º–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤<br/>–û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é"]
    
    TE --> Smoothing["–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è<br/>–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è"]
    
    style TE fill:#4CAF50,color:#fff
    style LE fill:#2196F3,color:#fff
    style OH fill:#FF9800,color:#fff
```

### 4. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è PU Learning

```mermaid
graph TB
    subgraph Problem["‚ùó –ü—Ä–æ–±–ª–µ–º–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞"]
        Original["–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ<br/>1000 –ø—Ä–∏–º–µ—Ä–æ–≤<br/>10 –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö (1%)"]
    end
    
    subgraph RandomSplit["‚ùå –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ"]
        RTrain["Train: 800<br/>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö: 8 üòä"]
        RTest["Test: 200<br/>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö: 2 üò∞"]
        RTestBad["–ò–ª–∏ —Ö—É–∂–µ:<br/>Test: 200<br/>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö: 0 ‚ò†Ô∏è"]
    end
    
    subgraph StratifiedSplit["‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ"]
        STrain["Train: 800<br/>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö: 8 ‚úÖ<br/>(1% —Å–æ—Ö—Ä–∞–Ω—ë–Ω)"]
        STest["Test: 200<br/>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö: 2 ‚úÖ<br/>(1% —Å–æ—Ö—Ä–∞–Ω—ë–Ω)"]
    end
    
    Original --> RandomSplit
    Original --> StratifiedSplit
    
    RTrain -.->|"–†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏<br/>–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö"| RTestBad
    
    style Problem fill:#FFEBEE,stroke:#F44336
    style RandomSplit fill:#FFF3E0,stroke:#FF9800
    style StratifiedSplit fill:#E8F5E9,stroke:#4CAF50
    style RTestBad fill:#F44336,color:#fff
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### PreprocessingStatistics
–°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏:

```mermaid
classDiagram
    class PreprocessingStatistics {
        +int train_size
        +int test_size
        +float train_positive_ratio
        +float test_positive_ratio
        +bool missing_handled
        +Dict missing_strategies
        +int n_numerical_features
        +int n_categorical_features
        +List categorical_features
        +List numerical_features
        +str categorical_encoding_method
        +bool scaling_applied
        +Dict scaling_stats
        +List constant_features_removed
        +List high_cardinality_warnings
        +to_dict() Dict
    }
```

### PreprocessingPipeline
–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

```mermaid
classDiagram
    class PreprocessingPipeline {
        +Dict imputers
        +StandardScaler scaler
        +Dict encoders
        +List feature_order
        +List categorical_features
        +List numerical_features
        +transform(X) DataFrame
    }
```

## üîÑ Workflow –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏

```mermaid
flowchart TD
    Start([–ù–∞—á–∞–ª–æ]) --> LoadData[/"–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"/]
    
    LoadData --> SeparateXY[–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ X –∏ y]
    
    SeparateXY --> RemoveConstant{–£–¥–∞–ª—è—Ç—å<br/>–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ?}
    RemoveConstant -->|–î–∞| RemoveConst[–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤]
    RemoveConstant -->|–ù–µ—Ç| IdentifyTypes
    RemoveConst --> IdentifyTypes[–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤]
    
    IdentifyTypes --> DetectCat["üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ"]
    IdentifyTypes --> DetectNum["üìä –ß–∏—Å–ª–æ–≤—ã–µ"]
    
    DetectCat --> SplitData
    DetectNum --> SplitData[Train/Test split<br/>—Å–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π]
    
    SplitData --> CheckBalance{–ë–∞–ª–∞–Ω—Å<br/>—Å–æ—Ö—Ä–∞–Ω—ë–Ω?}
    CheckBalance -->|–ù–µ—Ç| WarnBalance[‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ]
    CheckBalance -->|–î–∞| HandleMissing
    WarnBalance --> HandleMissing
    
    HandleMissing[–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤] --> ImputeNum[–ò–º–ø—É—Ç–∞—Ü–∏—è —á–∏—Å–ª–æ–≤—ã—Ö<br/>–º–µ–¥–∏–∞–Ω–∞/—Å—Ä–µ–¥–Ω–µ–µ]
    HandleMissing --> ImputeCat[–ò–º–ø—É—Ç–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö<br/>–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞/–º–æ–¥–∞]
    
    ImputeNum --> Encode
    ImputeCat --> Encode[–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö]
    
    Encode --> EncMethod{–ú–µ—Ç–æ–¥?}
    EncMethod -->|Target| TargetEnc[Target Encoding<br/>—Å smoothing]
    EncMethod -->|Label| LabelEnc[Label Encoding]
    EncMethod -->|OneHot| OneHotEnc[One-Hot Encoding]
    
    TargetEnc --> Scale
    LabelEnc --> Scale
    OneHotEnc --> Scale[–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö]
    
    Scale --> ScaleMethod{–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å?}
    ScaleMethod -->|–î–∞| StandardScale[StandardScaler<br/>mean=0, std=1]
    ScaleMethod -->|–ù–µ—Ç| CollectStats
    
    StandardScale --> CollectStats[–°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏]
    CollectStats --> CreatePipeline[–°–æ–∑–¥–∞–Ω–∏–µ Pipeline]
    
    CreatePipeline --> Output([–í—ã–≤–æ–¥:<br/>X_train, X_test,<br/>y_train, y_test,<br/>stats, pipeline])
    
    style Start fill:#4CAF50,color:#fff
    style Output fill:#2196F3,color:#fff
    style SplitData fill:#FF9800,color:#fff
    style TargetEnc fill:#9C27B0,color:#fff
    style CreatePipeline fill:#4CAF50,color:#fff
```

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from pu_data_preprocessor import preprocess_data

# –ü–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
X_train, X_test, y_train, y_test, stats, pipeline = preprocess_data(
    validated_df, 
    target_column='target'
)

print(stats)  # –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
config = {
    'test_size': 0.3,  # 30% –Ω–∞ —Ç–µ—Å—Ç
    'scale_features': True,  # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
    'encoding_method': 'target',  # Target encoding –¥–ª—è PU
    'numerical_impute_strategy': 'median',
    'high_cardinality_threshold': 100
}

X_train, X_test, y_train, y_test, stats, pipeline = preprocess_data(
    validated_df, 'target', config
)
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
```python
# –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
new_data = pd.read_csv('new_batch.csv')
X_new = new_data.drop(columns=['target'])

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–≥–æ –∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
X_new_transformed = pipeline.transform(X_new)
```

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è PU Learning

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

```mermaid
graph LR
    subgraph Challenge["üéØ –í—ã–∑–æ–≤ PU Learning"]
        Rare["–û—á–µ–Ω—å –º–∞–ª–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö<br/>–ø—Ä–∏–º–µ—Ä–æ–≤ (< 1%)"]
    end
    
    subgraph Solution["‚úÖ –†–µ—à–µ–Ω–∏–µ"]
        Strat["–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ<br/>—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ"]
        Target["Target Encoding<br/>–¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö"]
        Balance["–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞<br/>–≤ train –∏ test"]
    end
    
    Rare --> Strat
    Rare --> Target
    Strat --> Balance
    
    style Challenge fill:#FFEBEE,stroke:#F44336
    style Solution fill:#E8F5E9,stroke:#4CAF50
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

PU Learning –¥–∞—Ç–∞—Å–µ—Ç—ã —á–∞—Å—Ç–æ –∏–º–µ—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ç.–¥.):

- **Target Encoding** - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è PU Learning
- **–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** - –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å > 50 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

### –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- [x] –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ train/test —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- [x] –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- [x] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- [x] –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ PU Learning
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- [x] Target encoding –¥–ª—è –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤
- [x] –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- [x] –ë–∞–∑–æ–≤–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
- [x] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [x] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞
- [x] –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ PU —Å—Ü–µ–Ω–∞—Ä–∏–∏
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `researches/PU/experiment/pu_data_preprocessor.py` - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
- `researches/PU/experiment/demo/pu_demo_preprocessing.py` - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
- `researches/PU/experiment/docs/pu_step2_docs.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

*–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: [–®–∞–≥ 3 - –°–∏–º—É–ª—è—Ü–∏—è PU —Å—Ü–µ–Ω–∞—Ä–∏—è ‚Üí](step3_pu_simulation.md)*