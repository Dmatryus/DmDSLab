<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤—ã–±–æ—Ä—É –ø–æ—Ä–æ–≥–æ–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Å–µ–≤–¥–æ-—Ä–∞–∑–º–µ—Ç–∫–∏</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #7c3aed;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #1f2937;
            --light-bg: #f9fafb;
            --border-color: #e5e7eb;
            --text-muted: #6b7280;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: var(--light-bg);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 60px 0;
            text-align: center;
            margin-bottom: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        nav {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 40px;
            position: sticky;
            top: 20px;
            z-index: 100;
        }
        
        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        
        nav a {
            color: var(--dark-color);
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        nav a:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .section {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        h2 {
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 2em;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        h3 {
            color: var(--dark-color);
            margin: 30px 0 20px;
            font-size: 1.5em;
        }
        
        .icon {
            font-size: 1.2em;
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç–æ–¥–æ–≤ */
        .methods-table {
            overflow-x: auto;
            margin: 30px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }
        
        th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        tr:hover {
            background-color: var(--light-bg);
        }
        
        .method-name {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .complexity-low {
            color: var(--success-color);
            font-weight: 600;
        }
        
        .complexity-medium {
            color: var(--warning-color);
            font-weight: 600;
        }
        
        .complexity-high {
            color: var(--danger-color);
            font-weight: 600;
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –º–µ—Ç–æ–¥–æ–≤ */
        .method-card {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .method-card h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .formula {
            background: white;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            border: 1px solid var(--border-color);
            overflow-x: auto;
        }
        
        code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        pre {
            background: #1f2937;
            color: #e5e7eb;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }
        
        /* –ë–ª–æ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π */
        .recommendation {
            background: #eef2ff;
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .warning {
            background: #fef3c7;
            border-left: 4px solid var(--warning-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        /* –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä */
        .quick-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .select-card {
            background: var(--light-bg);
            padding: 25px;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .select-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .select-card h5 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .tag {
            display: inline-block;
            padding: 4px 12px;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            margin: 2px;
        }
        
        .tag.secondary {
            background: var(--secondary-color);
        }
        
        .tag.success {
            background: var(--success-color);
        }
        
        .tag.warning {
            background: var(--warning-color);
        }
        
        /* –°–ø–∏—Å–∫–∏ */
        ul, ol {
            margin: 15px 0 15px 30px;
        }
        
        li {
            margin: 8px 0;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 40px 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .section {
                padding: 20px;
            }
            
            nav ul {
                flex-direction: column;
                gap: 10px;
            }
            
            table {
                font-size: 0.85em;
            }
            
            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ –ú–µ—Ç–æ–¥—ã –≤—ã–±–æ—Ä–∞ –ø–æ—Ä–æ–≥–æ–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏</h1>
        </header>
        
        <nav>
            <ul>
                <li><a href="#overview">–û–±–∑–æ—Ä</a></li>
                <li><a href="#table">–¢–∞–±–ª–∏—Ü–∞ –º–µ—Ç–æ–¥–æ–≤</a></li>
                <li><a href="#quick-select">–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä</a></li>
                <li><a href="#statistical">–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ</a></li>
                <li><a href="#business">–ë–∏–∑–Ω–µ—Å-–º–µ—Ç–æ–¥—ã</a></li>
                <li><a href="#heuristic">–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ</a></li>
                <li><a href="#multiclass">–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤—ã–µ</a></li>
                <li><a href="#adaptive">–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ</a></li>
                <li><a href="#uncertainty">–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å</a></li>
            </ul>
        </nav>
        
        <section id="overview" class="section">
            <h2><span class="icon">üìñ</span> –û–±–∑–æ—Ä</h2>
            <p>–í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —ç—Ç–∞–ø –≤ –∑–∞–¥–∞—á–∞—Ö –ø—Å–µ–≤–¥–æ-—Ä–∞–∑–º–µ—Ç–∫–∏ –∏ –ø–æ–ª—É–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –û—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ø–æ—Ä–æ–≥–∞ –∑–∞–≤–∏—Å–∏—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º –ø—Å–µ–≤–¥–æ-–º–µ—Ç–æ–∫.</p>
            
            <div class="recommendation">
                <strong>üí° –ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø:</strong> –í –ø—Å–µ–≤–¥–æ-—Ä–∞–∑–º–µ—Ç–∫–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã—Å–æ–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é, —á–µ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö —Å —à—É–º–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏.
            </div>
            
            <h3>–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –≤—ã–±–æ—Ä—É –ø–æ—Ä–æ–≥–∞</h3>
            <ul>
                <li><strong>–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏:</strong> –ü—Ä–æ—Å—Ç—ã–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏</li>
                <li><strong>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:</strong> –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
                <li><strong>–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è</li>
                <li><strong>–£—á–µ—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –Ø–≤–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏</li>
            </ul>
        </section>
        
        <section id="table" class="section">
            <h2><span class="icon">üìä</span> –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–µ—Ç–æ–¥–æ–≤</h2>
            <div class="methods-table">
                <table>
                    <thead>
                        <tr>
                            <th>–ú–µ—Ç–æ–¥</th>
                            <th>–¢–∏–ø –∑–∞–¥–∞—á–∏</th>
                            <th>–§–æ—Ä–º—É–ª–∞</th>
                            <th>–¢—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é</th>
                            <th>–°–ª–æ–∂–Ω–æ—Å—Ç—å</th>
                            <th>–¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</th>
                            <th>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="method-name">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ F1</td>
                            <td>–ë–∏–Ω–∞—Ä–Ω–∞—è</td>
                            <td><code>F1 = 2¬∑(P¬∑R)/(P+R)</code></td>
                            <td>–î–∞</td>
                            <td class="complexity-low">–ù–∏–∑–∫–∞—è</td>
                            <td>0.5-0.7</td>
                            <td>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏</td>
                        </tr>
                        <tr>
                            <td class="method-name">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Æ–¥–µ–Ω–∞</td>
                            <td>–ë–∏–Ω–∞—Ä–Ω–∞—è</td>
                            <td><code>J = TPR + TNR - 1</code></td>
                            <td>–î–∞</td>
                            <td class="complexity-low">–ù–∏–∑–∫–∞—è</td>
                            <td>0.3-0.6</td>
                            <td>–ë–∞–ª–∞–Ω—Å –æ—à–∏–±–æ–∫</td>
                        </tr>
                        <tr>
                            <td class="method-name">–£—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫</td>
                            <td>–ë–∏–Ω–∞—Ä–Ω–∞—è</td>
                            <td><code>Cost = FP¬∑C‚ÇÄ‚ÇÅ + FN¬∑C‚ÇÅ‚ÇÄ</code></td>
                            <td>–î–∞</td>
                            <td class="complexity-medium">–°—Ä–µ–¥–Ω—è—è</td>
                            <td>0.1-0.4</td>
                            <td>–ù–µ —Ä–∞–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–æ–∫</td>
                        </tr>
                        <tr>
                            <td class="method-name">–ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å–Ω—ã–π</td>
                            <td>–õ—é–±–∞—è</td>
                            <td><code>œÑ = quantile(p, q)</code></td>
                            <td>–ù–µ—Ç</td>
                            <td class="complexity-low">–ù–∏–∑–∫–∞—è</td>
                            <td>70-90%</td>
                            <td>–ë—ã—Å—Ç—Ä—ã–π baseline, –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–±—ä–µ–º–∞</td>
                        </tr>
                        <tr>
                            <td class="method-name">–≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π</td>
                            <td>–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è</td>
                            <td><code>H = -Œ£ p¬∑log(p)</code></td>
                            <td>–ù–µ—Ç</td>
                            <td class="complexity-low">–ù–∏–∑–∫–∞—è</td>
                            <td>H < 0.5-1.0</td>
                            <td>–ú–Ω–æ–≥–æ –∫–ª–∞—Å—Å–æ–≤ (10+)</td>
                        </tr>
                        <tr>
                            <td class="method-name">–ú–µ—Ç–æ–¥ –æ—Ç—Ä—ã–≤–∞ (Margin)</td>
                            <td>–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è</td>
                            <td><code>margin = p‚ÇÅ - p‚ÇÇ</code></td>
                            <td>–ù–µ—Ç</td>
                            <td class="complexity-low">–ù–∏–∑–∫–∞—è</td>
                            <td>&gt; 0.1-0.3</td>
                            <td>–ü–æ—Ö–æ–∂–∏–µ –∫–ª–∞—Å—Å—ã, fine-grained</td>
                        </tr>
                        <tr>
                            <td class="method-name">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞</td>
                            <td>–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è</td>
                            <td><code>p = softmax(z/T)</code></td>
                            <td>–î–∞</td>
                            <td class="complexity-medium">–°—Ä–µ–¥–Ω—è—è</td>
                            <td>T = 1.5-2.5</td>
                            <td>–£–ª—É—á—à–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏</td>
                        </tr>
                        <tr>
                            <td class="method-name">–°–∞–º–æ–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π</td>
                            <td>–õ—é–±–∞—è</td>
                            <td><code>œÑ‚Çú = Œª¬∑œÑ‚Çú‚Çã‚ÇÅ + (1-Œª)¬∑pÃÑ‚Çú</code></td>
                            <td>–ù–µ—Ç</td>
                            <td class="complexity-medium">–°—Ä–µ–¥–Ω—è—è</td>
                            <td>Œ± = 0.1-0.3</td>
                            <td>–î–ª–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</td>
                        </tr>
                        <tr>
                            <td class="method-name">Monte Carlo Dropout</td>
                            <td>–õ—é–±–∞—è</td>
                            <td><code>œÉ¬≤ = Var[p(y|x)]</code></td>
                            <td>–ù–µ—Ç</td>
                            <td class="complexity-high">–í—ã—Å–æ–∫–∞—è</td>
                            <td>œÉ < 0.1-0.2</td>
                            <td>–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <section id="quick-select" class="section">
            <h2><span class="icon">‚ö°</span> –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞</h2>
            
            <div class="quick-select">
                <div class="select-card">
                    <h5>–£ –º–µ–Ω—è –º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö (&lt; 100 –ø—Ä–∏–º–µ—Ä–æ–≤)</h5>
                    <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —à—É–º–∞</p>
                    <div>
                        <span class="tag">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 0.95</span>
                        <span class="tag">–ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å 90%</span>
                    </div>
                </div>
                
                <div class="select-card">
                    <h5>–ö–ª–∞—Å—Å—ã –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã</h5>
                    <p>–ú–µ—Ç–æ–¥—ã, —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –¥–∏—Å–±–∞–ª–∞–Ω—Å –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö</p>
                    <div>
                        <span class="tag">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Æ–¥–µ–Ω–∞</span>
                        <span class="tag">–£—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</span>
                    </div>
                </div>
                
                <div class="select-card">
                    <h5>–ú–Ω–æ–≥–æ –∫–ª–∞—Å—Å–æ–≤ (10+)</h5>
                    <p>–†–∞–±–æ—Ç–∞ —Å –ø–æ–ª–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</p>
                    <div>
                        <span class="tag">–≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π</span>
                        <span class="tag">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞</span>
                    </div>
                </div>
                
                <div class="select-card">
                    <h5>–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏</h5>
                    <p>–û—Ü–µ–Ω–∫–∞ –∏ —É—á–µ—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏</p>
                    <div>
                        <span class="tag">Monte Carlo Dropout</span>
                        <span class="tag">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 0.95+</span>
                    </div>
                </div>
                
                <div class="select-card">
                    <h5>–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h5>
                    <p>–≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è</p>
                    <div>
                        <span class="tag">–ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å–Ω—ã–π</span>
                        <span class="tag">–≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π</span>
                    </div>
                </div>
                
                <div class="select-card">
                    <h5>–ù—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ</h5>
                    <p>–ü—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π</p>
                    <div>
                        <span class="tag">–ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å–Ω—ã–π 80%</span>
                        <span class="tag">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥</span>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="statistical" class="section">
            <h2><span class="icon">üìà</span> –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã</h2>
            
            <div class="method-card">
                <h4>1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ F1-–º–µ—Ä–µ</h4>
                
                <p>F1-–º–µ—Ä–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π. –≠—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á.</p>
                
                <div class="formula">
F1 = 2 ¬∑ (precision ¬∑ recall) / (precision + recall)

–≥–¥–µ:
precision = TP / (TP + FP)
recall = TP / (TP + FN)
                </div>
                
                <h5>–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:</h5>
                <pre><code>from sklearn.metrics import precision_recall_curve

def optimize_f1_threshold(y_true, y_proba):
    precisions, recalls, thresholds = precision_recall_curve(y_true, y_proba)
    f1_scores = 2 * (precisions * recalls) / (precisions + recalls + 1e-10)
    optimal_idx = np.argmax(f1_scores[:-1])
    return thresholds[optimal_idx], f1_scores[optimal_idx]

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
threshold, f1 = optimize_f1_threshold(y_val, probas_val)
confident_mask = probas_unlabeled >= threshold</code></pre>
                
                <div class="recommendation">
                    <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong>
                    <ul>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–π –æ—Ü–µ–Ω–∫–∏ –ø–æ—Ä–æ–≥–∞</li>
                        <li>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ—Ä–æ–≥–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ–ª–¥–∞—Ö</li>
                        <li>–î–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ weighted F1</li>
                    </ul>
                </div>
            </div>
            
            <div class="method-card">
                <h4>2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Æ–¥–µ–Ω–∞ (Youden's J statistic)</h4>
                
                <p>–ú–µ—Ç–æ–¥ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—É–º–º—É —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏, –Ω–∞—Ö–æ–¥—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É true positive –∏ true negative rates.</p>
                
                <div class="formula">
J = Sensitivity + Specificity - 1 = TPR + TNR - 1

–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç ROC-–∫—Ä–∏–≤–æ–π –¥–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
                </div>
                
                <h5>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ:</h5>
                <pre><code>from sklearn.metrics import roc_curve

def youden_j_threshold(y_true, y_proba):
    fpr, tpr, thresholds = roc_curve(y_true, y_proba)
    j_scores = tpr - fpr  # Youden's J statistic
    optimal_idx = np.argmax(j_scores)
    return thresholds[optimal_idx], j_scores[optimal_idx]

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∞
threshold, j_score = youden_j_threshold(y_test, probas_test)
print(f"–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥: {threshold:.3f}")
print(f"–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {tpr[optimal_idx]:.1%}")
print(f"–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å: {1-fpr[optimal_idx]:.1%}")</code></pre>
                
                <div class="warning">
                    <strong>–í–∞–∂–Ω–æ:</strong> –ú–µ—Ç–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ä–∞–≤–Ω—É—é –≤–∞–∂–Ω–æ—Å—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏. –í —Ä–µ–∞–ª—å–Ω—ã—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö —á–∞—Å—Ç–æ –≤–∞–∂–Ω–µ–µ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –±–æ–ª–µ–∑–Ω—å (–≤—ã—Å–æ–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å).
                </div>
            </div>
        </section>
        
        <section id="business" class="section">
            <h2><span class="icon">üí∞</span> –ë–∏–∑–Ω–µ—Å-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã</h2>
            
            <div class="method-card">
                <h4>3. –£—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫ (Cost-sensitive)</h4>
                
                <p>–ú–µ—Ç–æ–¥ –Ω–∞–ø—Ä—è–º—É—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏, —É—á–∏—Ç—ã–≤–∞—è —Ä–∞–∑–ª–∏—á–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–æ–∫ –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ —Ä–æ–¥–∞.</p>
                
                <div class="formula">
Expected Cost = P(FP) √ó Cost(FP) + P(FN) √ó Cost(FN)

–ü—Ä–∏–º–µ—Ä –¥–ª—è fraud detection:
- Cost(FP) = $1 (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
- Cost(FN) = $100 (–ø—Ä–æ–ø—É—Å–∫ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
                </div>
                
                <h5>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —É—á–µ—Ç–æ–º –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:</h5>
                <pre><code>class CostSensitiveThreshold:
    def __init__(self, cost_fp=1, cost_fn=10):
        self.cost_fp = cost_fp
        self.cost_fn = cost_fn
        
    def find_optimal_threshold(self, y_true, y_proba):
        thresholds = np.linspace(0, 1, 1000)
        costs = []
        
        for threshold in thresholds:
            y_pred = (y_proba >= threshold).astype(int)
            
            # –ü–æ–¥—Å—á–µ—Ç –æ—à–∏–±–æ–∫
            fp = np.sum((y_pred == 1) & (y_true == 0))
            fn = np.sum((y_pred == 0) & (y_true == 1))
            
            # –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
            total_cost = fp * self.cost_fp + fn * self.cost_fn
            costs.append(total_cost)
        
        optimal_idx = np.argmin(costs)
        return thresholds[optimal_idx], costs[optimal_idx]
    
    def calculate_savings(self, y_true, y_proba, threshold):
        """–†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ—Ä–æ–≥–æ–º 0.5"""
        baseline_cost = self._calculate_cost(y_true, y_proba >= 0.5)
        optimal_cost = self._calculate_cost(y_true, y_proba >= threshold)
        savings = baseline_cost - optimal_cost
        return savings, (savings / baseline_cost) * 100

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞
selector = CostSensitiveThreshold(cost_fp=100, cost_fn=1000)  # FN –¥–æ—Ä–æ–∂–µ –≤ 10 —Ä–∞–∑
threshold, cost = selector.find_optimal_threshold(y_val, probas_val)
savings, savings_pct = selector.calculate_savings(y_val, probas_val, threshold)

print(f"–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥: {threshold:.3f}")
print(f"–≠–∫–æ–Ω–æ–º–∏—è: ${savings:,.0f} ({savings_pct:.1f}%)")</code></pre>
                
                <div class="recommendation">
                    <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã:</strong>
                    <ul>
                        <li>–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –º–∞—Ç—Ä–∏—Ü—É —Å—Ç–æ–∏–º–æ—Å—Ç–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>–£—á–∏—Ç—ã–≤–∞–π—Ç–µ –∫–æ—Å–≤–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã (—Ä–µ–ø—É—Ç–∞—Ü–∏—è, –¥–æ–≤–µ—Ä–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤)</li>
                        <li>–ü—Ä–æ–≤–æ–¥–∏—Ç–µ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section id="heuristic" class="section">
            <h2><span class="icon">üí°</span> –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã</h2>
            
            <div class="method-card">
                <h4>4. –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥</h4>
                
                <p>–ü—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–π –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –í—ã–±–∏—Ä–∞–µ—Ç –ø–æ—Ä–æ–≥ –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.</p>
                
                <h5>–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:</h5>
                <pre><code>class PercentileThresholdSelector:
    def __init__(self, initial_percentile=80):
        self.percentile = initial_percentile
        self.history = []
        
    def select_threshold(self, probabilities):
        """–í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è"""
        threshold = np.percentile(probabilities, self.percentile)
        self.history.append({
            'threshold': threshold,
            'percentile': self.percentile,
            'n_selected': np.sum(probabilities >= threshold)
        })
        return threshold
    
    def adapt_percentile(self, performance_metric):
        """–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—á–µ—Å—Ç–≤–∞"""
        if performance_metric < 0.9:  # –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ —É–ø–∞–ª–æ
            self.percentile = min(95, self.percentile + 5)
        elif performance_metric > 0.95:  # –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã—Å–æ–∫–æ–µ
            self.percentile = max(70, self.percentile - 2)
    
    def get_statistics(self):
        """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"""
        if not self.history:
            return None
        
        thresholds = [h['threshold'] for h in self.history]
        return {
            'mean_threshold': np.mean(thresholds),
            'std_threshold': np.std(thresholds),
            'trend': 'increasing' if thresholds[-1] > thresholds[0] else 'decreasing'
        }

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
selector = PercentileThresholdSelector(initial_percentile=85)

for epoch in range(num_epochs):
    probas = model.predict_proba(X_unlabeled)[:, 1]
    threshold = selector.select_threshold(probas)
    
    # –û—Ç–±–æ—Ä —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
    confident_mask = probas >= threshold
    X_pseudo = X_unlabeled[confident_mask]
    y_pseudo = (probas[confident_mask] >= 0.5).astype(int)
    
    # –û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞
    model.fit(np.vstack([X_train, X_pseudo]), 
              np.hstack([y_train, y_pseudo]))
    
    # –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è
    val_score = model.score(X_val, y_val)
    selector.adapt_percentile(val_score)</code></pre>
            </div>
        </section>
        
        <section id="multiclass" class="section">
            <h2><span class="icon">üé®</span> –ú–µ—Ç–æ–¥—ã –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
            
            <div class="method-card">
                <h4>5. –≠–Ω—Ç—Ä–æ–ø–∏–π–Ω—ã–π –º–µ—Ç–æ–¥</h4>
                
                <p>–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏—é –®–µ–Ω–Ω–æ–Ω–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –∫–ª–∞—Å—Å–∞–º.</p>
                
                <div class="formula">
H(p) = -Œ£·µ¢ p_i ¬∑ log(p_i)

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- H = 0: –ø–æ–ª–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–æ–¥–∏–Ω –∫–ª–∞—Å—Å —Å p=1)
- H = log(n): –ø–æ–ª–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
                </div>
                
                <h5>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π:</h5>
                <pre><code>import matplotlib.pyplot as plt

class EntropyThresholdSelector:
    def __init__(self, max_entropy=0.5):
        self.max_entropy = max_entropy
        
    def calculate_entropy(self, proba_matrix):
        """–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞"""
        # –ò–∑–±–µ–≥–∞–µ–º log(0)
        proba_matrix = np.clip(proba_matrix, 1e-10, 1)
        entropy = -np.sum(proba_matrix * np.log(proba_matrix), axis=1)
        return entropy
    
    def select_confident_samples(self, proba_matrix, return_stats=False):
        """–û—Ç–±–æ—Ä –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –Ω–∏–∑–∫–æ–π —ç–Ω—Ç—Ä–æ–ø–∏–µ–π"""
        entropy = self.calculate_entropy(proba_matrix)
        confident_mask = entropy < self.max_entropy
        
        if return_stats:
            stats = {
                'mean_entropy': np.mean(entropy),
                'median_entropy': np.median(entropy),
                'selected_ratio': np.mean(confident_mask),
                'entropy_distribution': entropy
            }
            return confident_mask, stats
        
        return confident_mask
    
    def visualize_entropy_distribution(self, proba_matrix, save_path=None):
        """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–Ω—Ç—Ä–æ–ø–∏–∏"""
        entropy = self.calculate_entropy(proba_matrix)
        confident_mask = entropy < self.max_entropy
        
        fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))
        
        # –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —ç–Ω—Ç—Ä–æ–ø–∏–∏
        ax1.hist(entropy, bins=50, alpha=0.7, color='blue', edgecolor='black')
        ax1.axvline(self.max_entropy, color='red', linestyle='--', 
                   label=f'Threshold: {self.max_entropy}')
        ax1.set_xlabel('–≠–Ω—Ç—Ä–æ–ø–∏—è')
        ax1.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤')
        ax1.set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏')
        ax1.legend()
        
        # Scatter plot: max probability vs entropy
        max_proba = np.max(proba_matrix, axis=1)
        ax2.scatter(entropy[~confident_mask], max_proba[~confident_mask], 
                   alpha=0.5, s=10, label='–û—Ç–∫–ª–æ–Ω–µ–Ω–æ')
        ax2.scatter(entropy[confident_mask], max_proba[confident_mask], 
                   alpha=0.7, s=20, label='–û—Ç–æ–±—Ä–∞–Ω–æ')
        ax2.set_xlabel('–≠–Ω—Ç—Ä–æ–ø–∏—è')
        ax2.set_ylabel('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å')
        ax2.set_title('–≠–Ω—Ç—Ä–æ–ø–∏—è vs –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å')
        ax2.legend()
        
        plt.tight_layout()
        if save_path:
            plt.savefig(save_path)
        plt.show()

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è 10-–∫–ª–∞—Å—Å–æ–≤–æ–π –∑–∞–¥–∞—á–∏
selector = EntropyThresholdSelector(max_entropy=1.0)  # log(10) ‚âà 2.3

# –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
confident_mask, stats = selector.select_confident_samples(proba_matrix, return_stats=True)
print(f"–°—Ä–µ–¥–Ω—è—è —ç–Ω—Ç—Ä–æ–ø–∏—è: {stats['mean_entropy']:.3f}")
print(f"–û—Ç–æ–±—Ä–∞–Ω–æ –ø—Ä–∏–º–µ—Ä–æ–≤: {stats['selected_ratio']:.1%}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
selector.visualize_entropy_distribution(proba_matrix)</code></pre>
            </div>
            
            <div class="method-card">
                <h4>6. –ú–µ—Ç–æ–¥ –æ—Ç—Ä—ã–≤–∞ (Margin-based)</h4>
                
                <p>–û—Ü–µ–Ω–∏–≤–∞–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –¥–≤—É–º—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –∑–∞–¥–∞—á —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –±–ª–∏–∑–∫–∏–º–∏ –∫–ª–∞—Å—Å–∞–º–∏.</p>
                
                <h5>–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:</h5>
                <pre><code>class MarginThresholdSelector:
    def __init__(self, min_margin=0.2):
        self.min_margin = min_margin
        
    def calculate_margins(self, proba_matrix):
        """–í—ã—á–∏—Å–ª–µ–Ω–∏–µ margin –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞"""
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ —É–±—ã–≤–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ
        sorted_proba = np.sort(proba_matrix, axis=1)[:, ::-1]
        
        # Margin = —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É top-2 –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏
        margins = sorted_proba[:, 0] - sorted_proba[:, 1]
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        top1_confidence = sorted_proba[:, 0]
        top2_confidence = sorted_proba[:, 1]
        
        return margins, top1_confidence, top2_confidence
    
    def analyze_confusion_pairs(self, proba_matrix, class_names=None):
        """–ê–Ω–∞–ª–∏–∑ –ø–∞—Ä –∫–ª–∞—Å—Å–æ–≤ —Å –Ω–∏–∑–∫–∏–º margin"""
        margins, top1_conf, top2_conf = self.calculate_margins(proba_matrix)
        
        # –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∏–º–µ—Ä—ã —Å –Ω–∏–∑–∫–∏–º margin
        low_margin_mask = margins < self.min_margin
        low_margin_indices = np.where(low_margin_mask)[0]
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–∞—Ä—ã –∫–ª–∞—Å—Å–æ–≤
        top2_classes = np.argsort(proba_matrix, axis=1)[:, -2:]
        
        confusion_pairs = {}
        for idx in low_margin_indices:
            class1, class2 = sorted(top2_classes[idx])
            pair = (class1, class2)
            
            if pair not in confusion_pairs:
                confusion_pairs[pair] = {
                    'count': 0,
                    'avg_margin': 0,
                    'examples': []
                }
            
            confusion_pairs[pair]['count'] += 1
            confusion_pairs[pair]['avg_margin'] += margins[idx]
            confusion_pairs[pair]['examples'].append(idx)
        
        # –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
        for pair in confusion_pairs:
            confusion_pairs[pair]['avg_margin'] /= confusion_pairs[pair]['count']
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ
        sorted_pairs = sorted(confusion_pairs.items(), 
                            key=lambda x: x[1]['count'], 
                            reverse=True)
        
        return sorted_pairs
    
    def adaptive_margin_threshold(self, proba_matrix, percentile=80):
        """–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è margins"""
        margins, _, _ = self.calculate_margins(proba_matrix)
        
        # –í—ã–±–∏—Ä–∞–µ–º –ø–æ—Ä–æ–≥ –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–µ
        adaptive_threshold = np.percentile(margins, 100 - percentile)
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        adaptive_threshold = np.clip(adaptive_threshold, 0.05, 0.5)
        
        return adaptive_threshold
    
    def select_with_class_specific_margins(self, proba_matrix, class_margins=None):
        """–û—Ç–±–æ—Ä —Å –∫–ª–∞—Å—Å–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏ margin"""
        margins, _, _ = self.calculate_margins(proba_matrix)
        predicted_classes = np.argmax(proba_matrix, axis=1)
        
        if class_margins is None:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ–¥–∏–Ω—ã–π –ø–æ—Ä–æ–≥
            confident_mask = margins >= self.min_margin
        else:
            # –ö–ª–∞—Å—Å–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏
            confident_mask = np.zeros(len(margins), dtype=bool)
            for class_idx, class_margin in enumerate(class_margins):
                class_mask = predicted_classes == class_idx
                confident_mask[class_mask] = margins[class_mask] >= class_margin
        
        return confident_mask

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è fine-grained –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
selector = MarginThresholdSelector(min_margin=0.15)

# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–∞—Ä –∫–ª–∞—Å—Å–æ–≤
confusion_pairs = selector.analyze_confusion_pairs(proba_matrix, class_names)
print("–ù–∞–∏–±–æ–ª–µ–µ –ø—É—Ç–∞–µ–º—ã–µ –ø–∞—Ä—ã –∫–ª–∞—Å—Å–æ–≤:")
for (c1, c2), stats in confusion_pairs[:5]:
    name1 = class_names[c1] if class_names else f"Class_{c1}"
    name2 = class_names[c2] if class_names else f"Class_{c2}"
    print(f"{name1} <-> {name2}: {stats['count']} –ø—Ä–∏–º–µ—Ä–æ–≤, "
          f"—Å—Ä–µ–¥–Ω–∏–π margin: {stats['avg_margin']:.3f}")

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞
adaptive_threshold = selector.adaptive_margin_threshold(proba_matrix, percentile=85)
print(f"\n–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ margin: {adaptive_threshold:.3f}")

# –û—Ç–±–æ—Ä —Å –∫–ª–∞—Å—Å–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏
# –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ—Ö–æ–∂–∏—Ö –∫–ª–∞—Å—Å–æ–≤ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥
class_margins = [0.1] * num_classes
class_margins[similar_class1] = 0.3
class_margins[similar_class2] = 0.3

confident_mask = selector.select_with_class_specific_margins(proba_matrix, class_margins)</code></pre>
            </div>
        </section>
        
        <section id="adaptive" class="section">
            <h2><span class="icon">üîÑ</span> –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã</h2>
            
            <div class="method-card">
                <h4>7. –°–∞–º–æ–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ (FreeMatch, FlexMatch)</h4>
                
                <p>–ú–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç –ø–æ—Ä–æ–≥–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.</p>
                
                <h5>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è FreeMatch:</h5>
                <pre><code>class FreeMatchThreshold:
    """
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –∏–∑ FreeMatch
    """
    def __init__(self, initial_threshold=0.95, momentum=0.999):
        self.global_threshold = initial_threshold
        self.class_thresholds = None
        self.momentum = momentum
        self.ema_predictions = None
        self.update_count = 0
        
    def update(self, proba_matrix):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ EMA –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"""
        max_proba = np.max(proba_matrix, axis=1)
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥
        if self.update_count == 0:
            self.global_threshold = np.mean(max_proba)
        else:
            self.global_threshold = (self.momentum * self.global_threshold + 
                                   (1 - self.momentum) * np.mean(max_proba))
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏
        if self.class_thresholds is None:
            n_classes = proba_matrix.shape[1]
            self.class_thresholds = np.full(n_classes, self.global_threshold)
            self.ema_predictions = np.zeros(n_classes)
        
        # EMA –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
        class_means = np.mean(proba_matrix, axis=0)
        self.ema_predictions = (self.momentum * self.ema_predictions + 
                               (1 - self.momentum) * class_means)
        
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ—Ä–æ–≥–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∞
        relative_confidence = self.ema_predictions / np.max(self.ema_predictions)
        self.class_thresholds = self.global_threshold * relative_confidence
        
        self.update_count += 1
        
    def get_mask(self, proba_matrix):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Å–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤"""
        max_proba = np.max(proba_matrix, axis=1)
        predicted_classes = np.argmax(proba_matrix, axis=1)
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–ª–∞—Å—Å–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏
        confident_mask = np.zeros(len(proba_matrix), dtype=bool)
        for i, (prob, pred_class) in enumerate(zip(max_proba, predicted_classes)):
            if self.class_thresholds is not None:
                threshold = self.class_thresholds[pred_class]
            else:
                threshold = self.global_threshold
            
            confident_mask[i] = prob >= threshold
        
        return confident_mask
    
    def get_statistics(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Ä–æ–≥–æ–≤"""
        stats = {
            'global_threshold': self.global_threshold,
            'updates': self.update_count
        }
        
        if self.class_thresholds is not None:
            stats['class_thresholds'] = self.class_thresholds
            stats['min_class_threshold'] = np.min(self.class_thresholds)
            stats['max_class_threshold'] = np.max(self.class_thresholds)
            stats['threshold_std'] = np.std(self.class_thresholds)
        
        return stats

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –æ–±—É—á–∞—é—â–µ–º —Ü–∏–∫–ª–µ
threshold_manager = FreeMatchThreshold(initial_threshold=0.95, momentum=0.999)

for epoch in range(num_epochs):
    # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    with torch.no_grad():
        logits = model(unlabeled_data)
        proba = torch.softmax(logits, dim=1).numpy()
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Ä–æ–≥–∏
    threshold_manager.update(proba)
    
    # –ü–æ–ª—É—á–∞–µ–º –º–∞—Å–∫—É —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
    confident_mask = threshold_manager.get_mask(proba)
    
    # –°–æ–∑–¥–∞–µ–º –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏
    pseudo_labels = np.argmax(proba[confident_mask], axis=1)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    if epoch % 10 == 0:
        stats = threshold_manager.get_statistics()
        print(f"Epoch {epoch}: Global threshold: {stats['global_threshold']:.3f}, "
              f"Selected: {np.mean(confident_mask):.1%}")</code></pre>
            </div>
        </section>
        
        <section id="uncertainty" class="section">
            <h2><span class="icon">üé≤</span> –ú–µ—Ç–æ–¥—ã —É—á–µ—Ç–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏</h2>
            
            <div class="method-card">
                <h4>8. Monte Carlo Dropout</h4>
                
                <p>–ú–µ—Ç–æ–¥ –æ—Ü–µ–Ω–∫–∏ —ç–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –º–æ–¥–µ–ª–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º dropout.</p>
                
                <h5>–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏–∑–æ–º –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏:</h5>
                <pre><code>import torch
import torch.nn.functional as F

class MonteCarloUncertainty:
    """
    –û—Ü–µ–Ω–∫–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Monte Carlo Dropout
    """
    def __init__(self, n_iterations=50, uncertainty_threshold=0.1):
        self.n_iterations = n_iterations
        self.uncertainty_threshold = uncertainty_threshold
        
    def predict_with_uncertainty(self, model, x, return_all=False):
        """
        –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å –æ—Ü–µ–Ω–∫–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
        
        Returns:
            mean_proba: —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
            uncertainty: —ç–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
            aleatoric: –∞–ª–µ–∞—Ç–æ—Ä–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å (–¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)
        """
        # –í–∫–ª—é—á–∞–µ–º dropout –¥–ª—è inference
        model.train()
        
        predictions = []
        with torch.no_grad():
            for _ in range(self.n_iterations):
                logits = model(x)
                proba = F.softmax(logits, dim=-1)
                predictions.append(proba.cpu().numpy())
        
        predictions = np.array(predictions)
        
        # –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        mean_proba = np.mean(predictions, axis=0)
        
        # –≠–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å (—Ä–∞–∑–±—Ä–æ—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π)
        epistemic_uncertainty = np.var(predictions, axis=0)
        
        # –û–±—â–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç–Ω—Ç—Ä–æ–ø–∏—é —Å—Ä–µ–¥–Ω–∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
        predictive_entropy = -np.sum(mean_proba * np.log(mean_proba + 1e-10), axis=1)
        
        # –í–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ä–∞–∑–Ω–æ—Å—Ç—å —ç–Ω—Ç—Ä–æ–ø–∏–π)
        individual_entropies = -np.mean(
            np.sum(predictions * np.log(predictions + 1e-10), axis=2), 
            axis=0
        )
        mutual_information = predictive_entropy - individual_entropies
        
        if return_all:
            return {
                'mean_proba': mean_proba,
                'epistemic_uncertainty': epistemic_uncertainty,
                'predictive_entropy': predictive_entropy,
                'mutual_information': mutual_information,
                'all_predictions': predictions
            }
        
        # –î–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
        total_uncertainty = np.max(epistemic_uncertainty, axis=1)
        return mean_proba, total_uncertainty
    
    def select_confident_samples(self, model, x, method='epistemic'):
        """
        –û—Ç–±–æ—Ä –ø—Ä–∏–º–µ—Ä–æ–≤ —Å –Ω–∏–∑–∫–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å—é
        
        Args:
            method: 'epistemic', 'entropy', 'mutual_info', –∏–ª–∏ 'combined'
        """
        results = self.predict_with_uncertainty(model, x, return_all=True)
        
        if method == 'epistemic':
            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∞—Å—Å–∞–º
            uncertainty = np.max(results['epistemic_uncertainty'], axis=1)
            confident_mask = uncertainty < self.uncertainty_threshold
            
        elif method == 'entropy':
            # –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è
            confident_mask = results['predictive_entropy'] < self.uncertainty_threshold
            
        elif method == 'mutual_info':
            # –í–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            confident_mask = results['mutual_information'] < self.uncertainty_threshold
            
        elif method == 'combined':
            # –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤
            epistemic_mask = np.max(results['epistemic_uncertainty'], axis=1) < self.uncertainty_threshold
            entropy_mask = results['predictive_entropy'] < 1.0
            confident_mask = epistemic_mask & entropy_mask
            
        return confident_mask, results
    
    def analyze_uncertainty_sources(self, results):
        """–ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏"""
        # –†–∞–∑–¥–µ–ª—è–µ–º –ø—Ä–∏–º–µ—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—é –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
        high_epistemic = np.max(results['epistemic_uncertainty'], axis=1) > 0.1
        high_entropy = results['predictive_entropy'] > 1.0
        
        # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
        categories = {
            'confident': (~high_epistemic) & (~high_entropy),
            'ambiguous': (~high_epistemic) & high_entropy,  # –ú–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–∞, –Ω–æ –∫–ª–∞—Å—Å—ã –±–ª–∏–∑–∫–∏
            'uncertain': high_epistemic & (~high_entropy),   # –ú–æ–¥–µ–ª—å –Ω–µ —É–≤–µ—Ä–µ–Ω–∞
            'unknown': high_epistemic & high_entropy         # –ü–æ–ª–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
        }
        
        stats = {}
        for name, mask in categories.items():
            stats[name] = {
                'count': np.sum(mask),
                'percentage': np.mean(mask) * 100,
                'avg_max_proba': np.mean(np.max(results['mean_proba'][mask], axis=1)) if np.any(mask) else 0
            }
        
        return stats
    
    def visualize_uncertainty(self, results, save_path=None):
        """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∏–¥–æ–≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏"""
        import matplotlib.pyplot as plt
        
        fig, axes = plt.subplots(2, 2, figsize=(12, 10))
        
        # 1. –≠–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è vs –ê–ª–µ–∞—Ç–æ—Ä–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
        max_epistemic = np.max(results['epistemic_uncertainty'], axis=1)
        axes[0, 0].scatter(results['predictive_entropy'], max_epistemic, 
                          alpha=0.5, s=20)
        axes[0, 0].set_xlabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è')
        axes[0, 0].set_ylabel('–≠–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å')
        axes[0, 0].set_title('–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏')
        
        # 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
        axes[0, 1].hist(max_epistemic, bins=50, alpha=0.7, label='–≠–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è')
        axes[0, 1].hist(results['predictive_entropy'], bins=50, alpha=0.7, label='–≠–Ω—Ç—Ä–æ–ø–∏—è')
        axes[0, 1].axvline(self.uncertainty_threshold, color='red', linestyle='--')
        axes[0, 1].set_xlabel('–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å')
        axes[0, 1].set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
        axes[0, 1].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏')
        axes[0, 1].legend()
        
        # 3. –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å vs –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å
        max_proba = np.max(results['mean_proba'], axis=1)
        axes[1, 0].scatter(max_proba, max_epistemic, alpha=0.5, s=20)
        axes[1, 0].set_xlabel('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å')
        axes[1, 0].set_ylabel('–≠–ø–∏—Å—Ç–µ–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å')
        axes[1, 0].set_title('–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å vs –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å')
        
        # 4. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
        categories = self.analyze_uncertainty_sources(results)
        names = list(categories.keys())
        counts = [categories[n]['count'] for n in names]
        
        axes[1, 1].pie(counts, labels=names, autopct='%1.1f%%')
        axes[1, 1].set_title('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏')
        
        plt.tight_layout()
        if save_path:
            plt.savefig(save_path)
        plt.show()

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á
mc_selector = MonteCarloUncertainty(n_iterations=100, uncertainty_threshold=0.05)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å—é
confident_mask, results = mc_selector.select_confident_samples(
    model, X_unlabeled, method='combined'
)

# –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
uncertainty_stats = mc_selector.analyze_uncertainty_sources(results)
print("–ê–Ω–∞–ª–∏–∑ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏:")
for category, stats in uncertainty_stats.items():
    print(f"{category}: {stats['count']} –ø—Ä–∏–º–µ—Ä–æ–≤ ({stats['percentage']:.1f}%), "
          f"—Å—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {stats['avg_max_proba']:.3f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
mc_selector.visualize_uncertainty(results, 'uncertainty_analysis.png')</code></pre>
                
                <div class="warning">
                    <strong>–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã:</strong> MC Dropout —Ç—Ä–µ–±—É–µ—Ç 50-100 –ø—Ä–æ–≥–æ–Ω–æ–≤ –º–æ–¥–µ–ª–∏, —á—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è inference –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —á–∏—Å–ª–æ —Ä–∞–∑. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ batch processing –∏ GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è.
                </div>
            </div>
        </section>
        
        <section class="section">
            <h2><span class="icon">üéØ</span> –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
            
            <div class="recommendation">
                <h4>–ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è</h4>
                <ol>
                    <li><strong>–ù–∞—á–Ω–∏—Ç–µ —Å baseline:</strong> –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ (80-85%) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ü–µ–Ω–∫–∏</li>
                    <li><strong>–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ:</strong> –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏</li>
                    <li><strong>–í—ã–±–µ—Ä–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥:</strong> –ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∑–∞–¥–∞—á–∏</li>
                    <li><strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏–ª–∏ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏</li>
                    <li><strong>–í–Ω–µ–¥—Ä–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:</strong> –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Å–µ–≤–¥–æ-–º–µ—Ç–æ–∫</li>
                    <li><strong>–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞–π—Ç–µ:</strong> –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏</li>
                </ol>
            </div>
            
            <div class="warning">
                <h4>–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å</h4>
                <ul>
                    <li><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ 0.5 –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏:</strong> –í—Å–µ–≥–¥–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ—Ä–æ–≥ –ø–æ–¥ –≤–∞—à—É –∑–∞–¥–∞—á—É</li>
                    <li><strong>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏:</strong> –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ ECE (Expected Calibration Error)</li>
                    <li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏:</strong> –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</li>
                    <li><strong>–°—Ç–∞—Ç–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã</li>
                    <li><strong>–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤:</strong> –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–ª–∞—Å—Å-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã</li>
                </ul>
            </div>
        </section>
        
        <footer class="section" style="text-align: center; color: var(--text-muted);">
            <p>¬© 2025 Dmatryus Detry | –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤—ã–±–æ—Ä—É –ø–æ—Ä–æ–≥–æ–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ v1.0</p>
            <p>–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</p>
        </footer>
    </div>
</body>
</html>